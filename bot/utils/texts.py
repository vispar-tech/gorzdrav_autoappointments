from functools import partial
from typing import TYPE_CHECKING

from bot.utils.files import PRIVACY_POLICY_PATH, USER_AGREEMENT_PATH, read_txt_file

if TYPE_CHECKING:
    from bot.api.models import Attachment, PatientAppointmentItem
    from bot.db.models.patients import Patient

WELCOME_TEXT = """
üéâ <b>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ú–µ–¥–ë–æ—Ç –°–ü–±!</b> üè•

–ü—Ä–∏–≤–µ—Ç, {first_name}! üëã

–Ø –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–ø–∏—Å–∏ –∫ –≤—Ä–∞—á–∞–º –≤ —Å–∏—Å—Ç–µ–º–µ –ì–æ—Ä–ó–¥—Ä–∞–≤! üìÖ

<b>‚ú® –ß—Ç–æ —è —É–º–µ—é:</b>
‚Ä¢ üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–∫–∞—Ç—å —Å–≤–æ–±–æ–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∫ –Ω—É–∂–Ω—ã–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞–º
‚Ä¢ ‚è∞ –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤–∞—Å –Ω–∞ —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è (–≤ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
‚Ä¢ üîî –ú–≥–Ω–æ–≤–µ–Ω–Ω–æ —É–≤–µ–¥–æ–º–ª—è—Ç—å –æ –Ω–æ–≤—ã—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö
‚Ä¢ üìã –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –≤–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –∑–∞–ø–∏—Å–∏
‚Ä¢ üë• –î–æ–±–∞–≤–ª—è—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
‚Ä¢ üè• –†–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±–æ–π –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–æ–π –≤ —Å–∏—Å—Ç–µ–º–µ –ì–æ—Ä–ó–¥—Ä–∞–≤

<b>üí∞ –¢–∞—Ä–∏—Ñ—ã:</b>
‚Ä¢ <b>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ:</b> {max_unsubscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç, {max_unsubscribed_schedules} —Ä–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ üÜì
‚Ä¢ <b>–ü–ª–∞—Ç–Ω–æ:</b> 500‚ÇΩ/–º–µ—Å—è—Ü –∑–∞ –¥–æ {max_subscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, –¥–æ {max_subscribed_schedules} –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π üí≥

<b>üöÄ –ö–∞–∫ –Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É:</b>
1Ô∏è‚É£ –î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
3Ô∏è‚É£ –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—Å!

<b>üì± –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/patients - –ü–∞—Ü–∏–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/schedules - –í—Å–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/appointments - –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/help - –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

<b>üí° –í–∞–∂–Ω–æ:</b> –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –¥–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤

<b>‚ö†Ô∏è –°–æ–≥–ª–∞—Å–∏–µ:</b> –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞ –æ–∑–Ω–∞—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–≥–ª–∞—Å–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ–º –∏ –ø–æ–ª–∏—Ç–∏–∫–æ–π –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏.

–£–¥–∞—á–∏! üåü
"""  # noqa: E501

HELP_TEXT = """
üÜò <b>–ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–º–æ—â—å</b>

<b>üí∞ –¢–∞—Ä–∏—Ñ–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b>
‚Ä¢ <b>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ:</b> {max_unsubscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç, {max_unsubscribed_schedules} –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ üÜì
‚Ä¢ <b>–ü–ª–∞—Ç–Ω–æ:</b> 500‚ÇΩ/–º–µ—Å—è—Ü –∑–∞ –¥–æ {max_subscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, –¥–æ {max_subscribed_schedules} –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π üí≥

<b>üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç:</b>
1Ô∏è‚É£ <b>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤:</b> –î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
2Ô∏è‚É£ <b>–°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è:</b> –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
3Ô∏è‚É£ <b>–ê–≤—Ç–æ–ø–æ–∏—Å–∫:</b> –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—Å!

<b>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</b>
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π?</b> {max_unsubscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç, {max_unsubscribed_schedules} –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏, –∑–∞—Ç–µ–º —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω–æ üí∞
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å?</b> –í –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ - {max_unsubscribed_patients}, –≤ –ø–ª–∞—Ç–Ω–æ–π - –¥–æ {max_subscribed_patients} üë•
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –≤ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏?</b> –î–æ {max_subscribed_schedules} –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π üìÖ
‚Ä¢ <b>–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?</b> –î–∞, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–¥–µ–∂–Ω–æ –∑–∞—â–∏—â–µ–Ω—ã üîí
‚Ä¢ <b>–ö–∞–∫–∏–µ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã?</b> –í—Å–µ –≤ —Å–∏—Å—Ç–µ–º–µ –ì–æ—Ä–ó–¥—Ä–∞–≤ üè•
‚Ä¢ <b>–ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏?</b> –ö–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç ‚è∞
‚Ä¢ <b>–ú–æ–∂–Ω–æ –ª–∏ –≤—ã–±—Ä–∞—Ç—å —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è?</b> –¢–æ–ª—å–∫–æ –≤ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ ‚è∞

<b>üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/start - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
/patients - –ü–∞—Ü–∏–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/schedules - –í—Å–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/appointments - –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/help - –ü–æ–º–æ—â—å –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

<b>üÜò –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</b> @vispar_work
"""  # noqa: E501

FULL_HELP_TEXT = """
üÜò <b>–ü–æ–ª–Ω–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –±–æ—Ç—É –ì–æ—Ä–ó–¥—Ä–∞–≤</b> üè•

<b>üí∞ –¢–∞—Ä–∏—Ñ–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:</b>
‚Ä¢ <b>–ë–µ—Å–ø–ª–∞—Ç–Ω–æ:</b> {max_unsubscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç, {max_unsubscribed_schedules} –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –±–µ–∑ –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ üÜì
‚Ä¢ <b>–ü–ª–∞—Ç–Ω–æ:</b> 500‚ÇΩ/–º–µ—Å—è—Ü –∑–∞ –¥–æ {max_subscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤, –¥–æ {max_subscribed_schedules} –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π üí≥

<b>üìã –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:</b>
/start - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é –∏ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
/patients - –ü–∞—Ü–∏–µ–Ω—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/schedules - –í—Å–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/appointments - –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤—Å–µ—Ö –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤
/help - –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

<b>üîß –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–æ—Ç:</b>
1Ô∏è‚É£ <b>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤:</b> –î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
2Ô∏è‚É£ <b>–í—ã–±–æ—Ä –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∏:</b> –í—ã–±–µ—Ä–∏—Ç–µ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ–º—É—é –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫—É
3Ô∏è‚É£ <b>–ê–≤—Ç–æ–ø–æ–∏—Å–∫:</b> –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—Å!

<b>‚ùì –ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã:</b>
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π?</b> {max_unsubscribed_patients} –ø–∞—Ü–∏–µ–Ω—Ç, {max_unsubscribed_schedules} –µ–¥–∏–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏, –∑–∞—Ç–µ–º —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–Ω–æ üí∞
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å?</b> –í –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ - {max_unsubscribed_patients}, –≤ –ø–ª–∞—Ç–Ω–æ–π - –¥–æ {max_subscribed_patients} üë•
‚Ä¢ <b>–°–∫–æ–ª—å–∫–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π –≤ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏?</b> –î–æ {max_subscribed_schedules} –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π, –±–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–π üìÖ
‚Ä¢ <b>–ë–µ–∑–æ–ø–∞—Å–Ω–æ –ª–∏ —ç—Ç–æ?</b> –î–∞, –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞–¥–µ–∂–Ω–æ –∑–∞—â–∏—â–µ–Ω—ã üîí
‚Ä¢ <b>–ö–∞–∫–∏–µ –ø–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ã?</b> –í—Å–µ –≤ —Å–∏—Å—Ç–µ–º–µ –ì–æ—Ä–ó–¥—Ä–∞–≤ üè•
‚Ä¢ <b>–ö–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏?</b> –ö–∞–∂–¥—ã–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç ‚è∞
‚Ä¢ <b>–ú–æ–∂–Ω–æ –ª–∏ –≤—ã–±—Ä–∞—Ç—å —É–¥–æ–±–Ω–æ–µ –≤—Ä–µ–º—è?</b> –¢–æ–ª—å–∫–æ –≤ –ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏ ‚è∞

<b>üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç:</b>
1. –î–æ–±–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è –∑–∞–ø–∏—Å–∏
2. –°–æ–∑–¥–∞–π—Ç–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –∑–∞–ø–∏—Å–∏
3. –ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—â–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–µ –∑–∞–ø–∏—Å–∏ –∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤–∞—Å!

<b>üÜò –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞:</b> @vispar_work –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ /start –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
"""  # noqa: E501


def get_appointments_text(
    appointments_data: "list[tuple[Patient, Attachment, PatientAppointmentItem]]",
) -> str:
    """Format appointments data into a readable text."""
    if not appointments_data:
        return "<b>üìã –ó–∞–ø–∏—Å–∏</b>\n\n‚ùå –£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π –∫ –≤—Ä–∞—á–∞–º."

    text = "<b>üìã –í–∞—à–∏ –∑–∞–ø–∏—Å–∏ –∫ –≤—Ä–∞—á–∞–º</b>\n\n"

    for i, (patient, attachment, appointment) in enumerate(appointments_data, 1):
        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è
        visit_start = appointment.visit_start.strftime("%d.%m.%Y %H:%M")

        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏–º—è –ø–∞—Ü–∏–µ–Ω—Ç–∞
        patient_name = f"{patient.last_name} {patient.first_name}"
        if patient.middle_name:
            patient_name += f" {patient.middle_name}"

        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤—Ä–∞—á–µ
        doctor_info = ""
        if appointment.doctor_rending_consultation:
            doctor = appointment.doctor_rending_consultation
            doctor_name = doctor.name or "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
            doctor_info = f"üë®‚Äç‚öïÔ∏è <b>–í—Ä–∞—á:</b> {doctor_name}\n"
            if doctor.aria_number:
                doctor_info += f"üè• <b>–ö–∞–±–∏–Ω–µ—Ç:</b> {doctor.aria_number}\n"

        # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
        specialty_info = ""
        if appointment.speciality_rending_consultation:
            specialty = appointment.speciality_rending_consultation
            specialty_name = specialty.name or "–ù–µ —É–∫–∞–∑–∞–Ω–æ"
            specialty_info = f"ü©∫ <b>–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</b> {specialty_name}\n"

        text += f"{i}. <b>{patient_name}</b>\n"
        text += f"üìÖ <b>–î–∞—Ç–∞:</b> {visit_start}\n"
        lpu_name = attachment.lpu_short_name or attachment.lpu_full_name
        text += f"üè• <b>–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞:</b> {lpu_name}\n"
        if doctor_info:
            text += doctor_info
        if specialty_info:
            text += specialty_info
        text += f"üìû <b>–¢–µ–ª–µ—Ñ–æ–Ω:</b> {attachment.phone or '–ù–µ —É–∫–∞–∑–∞–Ω'}\n"

        if appointment.lpu_address:
            text += f"üìç <b>–ê–¥—Ä–µ—Å –ø—Ä–∏–µ–º–∞:</b> {appointment.lpu_address}\n"

        text += "\n\n"

    return text


get_user_aggrement_text = partial(read_txt_file, USER_AGREEMENT_PATH)
get_privacy_policy_text = partial(read_txt_file, PRIVACY_POLICY_PATH)
